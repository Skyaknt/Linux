# Chương 8 : Hoán đổi bộ nhớ trong Linux ( Linux swap memory ) 


Linux chia RAM thành các vùng bộ nhớ gọi là các pages. Swapping là tiến trình mà một page của bộ nhớ 
sẽ được sao chép đến một phân vùng tạo sẵn ở ổ đĩa cứng, gọi là Swap space để tiết kiệm bộ nhớ cho Ram.
Dung lượng kết hợp giữa dung lượng Ram và các swap space là dung lượng của bộ nhớ ảo có sẵn. 

	1. Khi bộ nhớ đòi hỏi nhiều hơn so với bộ nhớ có sẵn, Kernel sẽ di chuyển các page ít được sử dụng 
vào Swap spaces và lấy bộ nhớ đã được giải phóng cấp thêm cho các tiến trình hiện tại đang chạy.

	2. Một số lượng lớn các pages chỉ được dùng cho việc khởi động hệ thống và sau đó sẽ không được sử dụng 
nữa. 

- So với RAM thì Swap space trên ổ cứng có tốc độ thấp hơn rất nhiều ( 10000 lần ) => càng nhiều hoạt động
swapping thì làm chậm tốc độ chạy các tiến trình.

- Đôi khi trong quá trình swapping, việc trao đổi quá nhiều sẽ tạo ra sự tắc nghẽn ( gọi là bottlenecks). 
Trường hợp một page được đưa vào Swap space và sau đó được đưa trở lại Ram thì trong thời gian mà page được
đưa vào Swap, hệ thống sẽ cố gắng tìm một không gian ram trống để cấp cho các ứng dụng đang chạy. Trong 
trường hợp này, nên nâng cấp dung lượng RAM hơn là sử dụng Swap space để cải thiện được tốc độ của các tiến trình.

- Có 2 hình thức swap space: **swap phân vùng** và **swap files**

	-  Swap partition là một phân vùng độc lập dành cho việc swap và không dữ liệu nào được lưu ở đó.

	- Swap file là một file đặc biệt nằm trong tệp hệ thống ở ổ một vị trí tạm thời trên đĩa cứng, nó sẽ lưu các thông tin và các file 
	mà RAM không sử dụng để giải phóng bộ nhớ ram. 

	![Imgur](https://i.imgur.com/PD1iCPX.jpg)
	
	
**Để thêm một khu vực Swap file, sử dụng lệnh sau :**

```
dd if=/dev/zero of=/var/swapfile bs=1M count=2048
chmod 600 /var/swapfile
mkswap /var/swapfile
echo /var/swapfile none swap defaults 0 0 | sudo tee -a /etc/fstab
swapon -a	
```
